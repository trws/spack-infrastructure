---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  annotations:
    fluxcd.io/ignore: 'true'
  name: runner-large-x86-tmp-pub
  namespace: gitlab
spec:
  chart:
    name: gitlab-runner
    repository: https://charts.gitlab.io
    version: 0.37.2
  releaseName: large-x86-tmp-pub
  values:
    checkInterval: 30
    concurrent: 10
    gitlabUrl: https://gitlab.spack.io/
    image: gitlab/gitlab-runner:alpine-v14.7.0
    imagePullPolicy: IfNotPresent
    metrics:
      enabled: true
    nodeSelector:
      spack.io/node-pool: base
    rbac:
      serviceAccountName: runner
    runners:
      cache: {}
      config: "[[runners]]\n  requestConcurrency =  10\n  output_limit = 4096\n  environment\
        \ = [\"FF_GITLAB_REGISTRY_HELPER_IMAGE=1\"]\n  [runners.kubernetes]\n    privileged\
        \ = false\n    cpu_request = \"8000m\"\n    memory_request = \"15379114Ki\"\
        \ # 14.666 Gi\n    namespace = \"pipeline\"\n    pollTimeout = 600  # ten\
        \ minutes\n    service_account = \"runner\"\n    [runners.kubernetes.node_selector]\n\
        \      \"kubernetes.io/arch\" = \"amd64\"\n      \"spack.io/node-pool\" =\
        \ \"glr-huge-tmp-pubb\"\n"
      helpers: {}
      image: busybox:1.32.0
      imagePullPolicy: if-not-present
      locked: false
      runUntagged: false
      secret: gitlab-gitlab-runner-secret
      services: {}
      tags: x86_64,avx,avx2,avx512,large,public,aws,spack
    terminationGracePeriodSeconds: 21600
    unregisterRunners: true
